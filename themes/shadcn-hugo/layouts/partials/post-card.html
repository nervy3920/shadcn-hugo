{{ $image := "" }}
{{ with .Resources.GetMatch "featured-image*" }}
  {{ $image = .RelPermalink }}
{{ else }}
  {{ $images := findRE "<img [^>]*src=\"([^\"]+)\"[^>]*>" .Content 1 }}
  {{ if ge (len $images) 1 }}
    {{ $image = (index $images 0 | replaceRE "<img [^>]*src=\"([^\"]+)\"[^>]*>" "$1") }}
  {{ end }}
{{ end }}

<div class="group relative flex flex-col overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm transition-all hover:shadow-md hover:-translate-y-1 duration-300 h-full">
  {{ if $image }}
  <div class="aspect-video w-full overflow-hidden">
    <img src="{{ $image }}" alt="{{ .Title }}" class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105">
  </div>
  {{ end }}
  
  <div class="flex flex-1 flex-col p-6">
    <div class="flex flex-col space-y-1.5 mb-4">
      <div class="flex items-center gap-2 text-xs text-muted-foreground mb-1">
        <i class="fa-regular fa-calendar"></i>
        <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2006年01月02日" }}</time>
      </div>
      <h3 class="text-xl font-bold leading-tight tracking-tight group-hover:text-primary transition-colors line-clamp-2">
        <a href="{{ .RelPermalink }}">{{ .Title }}</a>
      </h3>
    </div>
    
    <div class="flex-1 text-sm text-muted-foreground line-clamp-3 mb-4">
      {{ .Summary | plainify | truncate 100 }}
    </div>

    <div class="flex flex-wrap gap-2 mt-auto pt-4 border-t">
      {{ range .Params.tags }}
        <a href="{{ "tags/" | relURL }}{{ . | urlize }}" class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground gap-1">
          <i class="fa-solid fa-tag text-[10px]"></i>
          {{ . }}
        </a>
      {{ end }}
    </div>
  </div>
</div>