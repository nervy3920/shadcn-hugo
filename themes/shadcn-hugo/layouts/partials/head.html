<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Params.siteName }}{{ end }}</title>
  <meta name="description" content="{{ if .IsPage }}{{ .Summary | plainify | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}" />
  <meta name="keywords" content="{{ if .IsPage }}{{ with .Params.tags }}{{ delimit . ", " }}{{ end }}{{ else }}{{ .Site.Params.keywords }}{{ end }}" />
  <meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Params.siteName }}{{ end }}" />
  <meta property="og:description" content="{{ if .IsPage }}{{ .Summary | plainify | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}" />
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}" />
  <meta property="og:url" content="{{ .Permalink }}" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Params.siteName }}{{ end }}" />
  <meta name="twitter:description" content="{{ if .IsPage }}{{ .Summary | plainify | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}" />

  <!-- Fonts (Using Mirror for China) -->
  <link rel="preconnect" href="https://fonts.loli.net">
  <link rel="preconnect" href="https://gstatic.loli.net" crossorigin>
  <link href="https://fonts.loli.net/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

  <!-- Icons (Font Awesome via BootCDN) -->
  <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">

  {{ $styles := resources.Get "css/main.css" | postCSS }}
  {{ if hugo.IsServer }}
    <link rel="stylesheet" href="{{ $styles.RelPermalink }}" />
  {{ else }}
    {{ $styles = $styles | minify | fingerprint }}
    <link rel="stylesheet" href="{{ $styles.RelPermalink }}" integrity="{{ $styles.Data.Integrity }}" crossorigin="anonymous" />
  {{ end }}

  <script>
    if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }
  </script>

  <style>
    /* Smooth scrolling for TOC */
    html {
      scroll-behavior: smooth;
    }

    /* Custom scrollbar to match shadcn/ui */
    ::-webkit-scrollbar {
      width: 10px;
    }
    ::-webkit-scrollbar-track {
      @apply bg-background;
    }
    ::-webkit-scrollbar-thumb {
      @apply bg-muted rounded-full border-2 border-background;
    }
    ::-webkit-scrollbar-thumb:hover {
      @apply bg-muted-foreground/50;
    }

    /* Selection color */
    ::selection {
      @apply bg-primary/20 text-primary;
    }
  </style>
</head>
